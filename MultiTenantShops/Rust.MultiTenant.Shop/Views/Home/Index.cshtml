@using System.Security.Cryptography
@using Microsoft.AspNetCore.Http
@model TenantInfo
@inject IHttpContextAccessor HttpContextAccessor

@{
    ViewData["Title"] = "EFCoreStore Sample";
    var tenantInfo = HttpContextAccessor.HttpContext.GetMultiTenantContext().TenantInfo;
}

@if (Model != null)
{
    <h3 class="mt-4">TenantInfo Values</h3>

    <table class="table">
        <thead>
            <tr>
                <th style="width:25%">Property</th>
                <th>Value</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>@nameof(Model.Id)</td>
                <td>@Model.Id</td>
            </tr>
            <tr>
                <td>@nameof(Model.Identifier)</td>
                <td>@Model.Identifier</td>
            </tr>
            <tr>
                <td>@nameof(Model.Name)</td>
                <td>@Model.Name</td>
            </tr>
            <tr>
                <td>@nameof(Model.ConnectionString)</td>
                <td>@Model.ConnectionString</td>
            </tr>
        </tbody>

    </table>
}

<div class="jumbotron">
    @if (User?.Identity?.IsAuthenticated ?? false)
    {
        <h1>Welcome, @User.Identity.Name</h1>
        <h1>Tenant info, @Model.Identifier</h1>

        <p>
            @foreach (var claim in Context.User.Claims)
            {
                <div><code>@claim.Type</code>: <strong>@claim.Value</strong></div>
            }
        </p>

        <a class="btn btn-lg btn-danger" href="@($"/{tenantInfo.Identifier}/authentication/signout")">Sign out</a>
    }
    else
    {
        <h1>Welcome, anonymous</h1>

        @if (tenantInfo != null)
        {
            <a class="btn btn-lg btn-success" href="@($"/{tenantInfo.Identifier}/authentication/signin")">Sign in</a>
        }
        else
        {
            <h1>No tenant!No tenant!No tenant!No tenant!</h1>
        }
    }
</div>