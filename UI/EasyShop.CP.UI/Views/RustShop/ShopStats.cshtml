@using EasyShop.Domain.Enums.Rust
@using Microsoft.AspNetCore.Http
@using Microsoft.EntityFrameworkCore.Internal
@model EasyShop.Domain.ViewModels.Rust.Shop.RustShopViewModel
@{
    ViewData["Title"] = "Rust shop";
    Layout = "Partial/_RustBaseLayout";

    #region SelectPeriod

    string selectOptions = string.Empty;
    foreach (var item in Model.StatsPeriodList)
    {
        if (item == Model.StatsPeriod)
        {
            selectOptions += $@"<option value=""{item}"" selected=""selected"">{item.ToString().Replace("_", " ")}</option>";
        }
        else
        {
            selectOptions += $@"<option value=""{item}"">{item.ToString().Replace("_", " ")}</option>";
        }
    }

    #endregion SelectPeriod

    #region RevenueData

    var revenueData = Model.Stats.FirstOrDefault(x => x.Key == RustShopStatsUnitEnum.Revenue);
    string revenueDates = string.Empty;
    string revenueTotal = revenueData.Value.Item2.Select(x => Decimal.Parse(x)).Sum().ToString();
    string revenueValues = string.Join(", ", revenueData.Value.Item2);
    string revenueValuesMax = (revenueData.Value.Item2.Select(x => Decimal.Parse(x)).Max() + 1).ToString();
    for (int i = 0; i < revenueData.Value.Item1.Count(); i++)
    {
        string item = revenueData.Value.Item1.ElementAt(i);

        if (i != revenueData.Value.Item1.Count() - 1)
        {
            revenueDates += $"\"{item}\", ";
        }
        else
        {
            revenueDates += $"\"{item}\"";
        }
    }

    #endregion RevenueData

    #region OrdersData



    #endregion OrdersData

}

<div class="row">
    <div class="col-xs-2 col-xs-offset-10 m-b-md">
        <div class="title-bar">
            <div class="title-bar-actions">
                <div class="btn-group bootstrap-select dropdown fit-width">
                    <select id="selectPeriod" class="selectpicker dropdown" name="period" data-dropdown-align-right="true" data-style="btn-default btn-sm" data-width="fit" tabindex="-98">
                        @Html.Raw(selectOptions)
                    </select>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="row gutter-xs">
    <div class="col-xs-6 col-md-3">
        <div class="card">
            <div class="card-values">
                <div class="p-x">
                    <small>Revenue</small>
                    <h3 class="card-title fw-l">$@revenueTotal</h3>
                </div>
            </div>
            <div class="card-chart">
                <canvas data-chart="line"
                        data-animation="false"
                        data-labels='[@revenueDates]'
                        data-values='[{"backgroundColor": "rgba(255, 255, 255, 0.1)", "borderColor": "#00aced", "data": [@revenueValues]}]'
                        data-scales='{"yAxes": [{ "ticks": {"max": @revenueValuesMax}}]}'
                        data-hide='["legend", "points", "scalesX", "scalesY", "tooltips"]'
                        height="35"></canvas>
            </div>
        </div>
    </div>
    <div class="col-xs-6 col-md-3">
        <div class="card">
            <div class="card-values">
                <div class="p-x">
                    <small>Orders</small>
                    <h3 class="card-title fw-l">68,494</h3>
                </div>
            </div>
            <div class="card-chart">
                <canvas data-chart="line"
                        data-animation="false"
                        data-labels='["Jun 21", "Jun 20", "Jun 19", "Jun 18", "Jun 17", "Jun 16", "Jun 15"]'
                        data-values='[{"backgroundColor": "rgba(255, 255, 255, 0.1)", "borderColor": "#00aced", "data": [8796, 11317, 8678, 9452, 8453, 11853, 9945]}]'
                        data-scales='{"yAxes": [{ "ticks": {"max": 12742}}]}'
                        data-hide='["legend", "points", "scalesX", "scalesY", "tooltips"]'
                        height="35"></canvas>
            </div>
        </div>
    </div>
    <div class="col-xs-6 col-md-3">
        <div class="card">
            <div class="card-values">
                <div class="p-x">
                    <small>Items Sold</small>
                    <h3 class="card-title fw-l">925,590</h3>
                </div>
            </div>
            <div class="card-chart">
                <canvas data-chart="line"
                        data-animation="false"
                        data-labels='["Jun 21", "Jun 20", "Jun 19", "Jun 18", "Jun 17", "Jun 16", "Jun 15"]'
                        data-values='[{"backgroundColor": "rgba(255, 255, 255, 0.1)", "borderColor": "#00aced", "data": [116196, 145160, 124419, 147004, 134740, 120846, 137225]}]'
                        data-scales='{"yAxes": [{ "ticks": {"max": 158029}}]}'
                        data-hide='["legend", "points", "scalesX", "scalesY", "tooltips"]'
                        height="35"></canvas>
            </div>
        </div>
    </div>
    <div class="col-xs-6 col-md-3">
        <div class="card">
            <div class="card-values">
                <div class="p-x">
                    <small>Buyers</small>
                    <h3 class="card-title fw-l">00:07:56</h3>
                </div>
            </div>
            <div class="card-chart">
                <canvas data-chart="line"
                        data-animation="false"
                        data-labels='["Jun 21", "Jun 20", "Jun 19", "Jun 18", "Jun 17", "Jun 16", "Jun 15"]'
                        data-values='[{"backgroundColor": "rgba(255, 255, 255, 0.1)", "borderColor": "#00aced", "data": [13590442, 12362934, 13639564, 13055677, 12915203, 11009940, 11542408]}]'
                        data-scales='{"yAxes": [{ "ticks": {"max": 14662531}}]}'
                        data-hide='["legend", "points", "scalesX", "scalesY", "tooltips"]'
                        height="35"></canvas>
            </div>
        </div>
    </div>
</div>
<div class="row gutter-xs">
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Revenue Overview</h4>
            </div>
            <div class="card-body">
                <div class="card-chart">
                    <canvas data-chart="line"
                            data-animation="false"
                            data-labels='["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]'
                            data-values='[
                            {
                                "label": "This week",
                                "backgroundColor": "transparent",
                                "borderColor": "#00aced",
                                "pointBackgroundColor": "#00aced",
                                "data": [29432, 20314, 17665, 22162, 31194, 35053, 29298]
                            },
                            {
                                "label": "Last week",
                                "backgroundColor": "transparent",
                                "borderColor": "#75ac00",
                                "pointBackgroundColor": "#75ac00",
                                "data": [9956, 22607, 30963, 22668, 16338, 22222, 39238]
                            }]'
                            data-tooltips='{"mode": "label"}'
                            data-hide='["gridLinesX", "legend"]'
                            height="150"></canvas>
                </div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Unique Visits Overview</h4>
            </div>
            <div class="card-body">
                <div class="card-chart">
                    <canvas data-chart="bar" data-animation="false" data-labels='["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"]' data-values='[{"label": "This week", "backgroundColor": "#00aced", "borderColor": "#00aced", "data": [3089, 2132, 1854, 2326, 3274, 3679, 3075]}, {"label": "Last week", "backgroundColor": "#75ac00", "borderColor": "#75ac00", "data": [983, 2232, 3057, 2238, 1613, 2194, 11980]}]' data-tooltips='{"mode": "label"}' data-hide='["gridLinesX", "legend"]' height="150"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts
{
    <script src="~/js/customScripts/Rust/RustShopStatsSetLocationHref.js" asp-append-version="true"></script>
}
